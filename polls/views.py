
#                                     ..,,,..
#                              ..,,;;;;;;;;;;;;;,.            
#                            '"     ;;;;;;;;';;;;;;,.           :F_P:
#                        .   ,  -'";.  ;;;;;;;';" ';;;,
#                       '  -' ';';; ;;   ;;;;;;'     "";,
#                    . "   ,;;,';,'; ;;   ;;;;;, ,;,_   ;,.'
#                   ;    ;";;;"        ";, """:;;;"';;;  ' ,
#                  ;   ;' ;"'            ;;,;;,  .;; ;;;   ,,,
#                 ;   ' ;;"               ;;;;;; ;;;  ;; ,;;;
#                   , ;; ;                " ;;;; ';',;;  ;;;
#                . ,' ;;;;                  ";;;, ; ;;'  ';;;
#                  , ,;';;                 ''";;;   ";    ';;;;
#               , ;  ;  ;;         _.,,     ' ";;, ,;;., ,;;;;;;
#              ,  ;, ;, ;;'"-    =" _,."'-   ' ;;;,;;;;;   ;;;;;;,
#             ,  ,;; '; .'"(o     .'(O)"-    ' ';;;;;;,  ,;;;;" ;;;
#        ' ,,    ;; ,;' ;;-"'      '   '    '  ;;;;;; ;   ';;;  ';;;
#              ,;;  ;'                      '  ;; ;;';   ,;;;    ;;'
#             ;;;   ;,   '  .'               ' ';;;;  ,;;; ;;  ,;;;
#           ,;;'    ';  ;;. '- = .'             ;;"; ;;;;'  "  ';;  ,
#           ;;   ,; '  ,;';   . _               ;; ' ;;;; .;  ,'" ,;;
#          ,;;  ;;;,   ;;,;;."_"_"=            ,;;  ,;;;;.;;,    ;;;'
#        ,''  ,;;;;;   ;;; ; ;," ,'            ;;' ;  ';;;;;;;,   ;'
#          .,;;;'      ;;; ;;  ""    .-""""''  ;; ;  ,;;";";;;;;,  ',
#         ;;;'        ;;; ,;;;._  .-"           ; ;,;;;' ;,';;;;;;;, '
#         ;;        .;;  ,;;;;;;;;"              ; ,;;'  ';  ";;;;;;;,
#          ;;      ;;   ,;;;;;;;;;'               ; ;' ;;;    ';;;;;;;;;
#           ;      ;;   ;;"';;;;;;                  ;;, ;;;;;   ;;;;;;;;;
#            '      ;;  ;;   ";;"                   ';;;';;"' ,;;;;,;;;
#                   ;;, ';    .                      ';;;,.' ,;;;;,;;;
#                  ,;;; ;'  .'                   '   ,;;;;;, ;;;;,;;;
#             ;, ,;;;' ,' .'                     '  ;;;;;;;; ;;;;;,;;;
#             ';;;'     .'      .                .  ';;;;;;   ;;;;;,;;;,
#                     .-        -                   ,;;;;;,    ';;;;;,;;;,
#                   .'          '.               ' ;;;;;;;;,  ,.  '";;;;;;
#                .-'             '                  ;;;;';;; ;;;;   ';;;;
#           . .-'                '               ' ;';;;;";; ';;;  ,;;;;
#           ::."                                   '; ";; ;;; ;" ,;;;;
#            "                   '               '  ;  '; ;;; ;  ;;;;'
#           '            '                           ; ;   "; '; ';;;,
#            .        .          '              '   ; "    ,;;;,  ;;;;
#                                                    ;    ;;;;;;  ;;;;,
#             '.    '            '              '     ; ;;;;;;;'   ";;;,
#               '.'                            .       ;;;;;"'    .,;;;
#                .               '                     ';;;'   ;;;;;;;
#                .                             '      '. ;;     ";;"' .
#                .               '            .      /  . '      ;
#               .               .             .     .                  '
#               '                                        '.             .
#              .              .'             '     '       .            '
#                                            '    .         .            .
#               .           '               '                .           '
#                          .               '     '           .            .
#               '         .              ,'      .         .'             .
#                .                      '         .      .'               |
#                        '             '               .'                ."
#                 '.   .              '            ' -'               .-'
#                   . .             /               '.             .-'
#                   ..            ,'                            .-'
#                   .            -                    '.     .-'
#                  .           -'                       '. .'
#                 .           '                           '.
#                .          ,'                              '.
#               '         .'                                  '.
#              '       . '                                .     '.
#             '         '                                  .      '.
#             '       '. '                                  .       .
#             '         -.                                  '.       .
#              '.      ' .                                   '.       .
#                .     ' .                                    '
#                 .     '.                                    .        .
#                  '. _   '.                                  '        .
#                  '.  '-.  '.                                '        .
#                    .   '"-. '.                             '         .
#                     .  '.  \_;                            .          .
#                       .  .                               -
#                      ';'. .                            .'            '
#                       .; \_                          .'             '
#                       . \;                          .  -  '        .
#                       | .                          .
#                        "                                          .
#                         '                          '
#                         '                          .
#                         .                          .             '
#                                                    '            -
#                         .                          .
#                         .                          .            .

#                         '                          .            '
#                          .
#                                                    '           '
#                          '                        .

#                           '                       .           '
#                            .
#                                                  .           '
#                             '
#                              .                   '
#                               .                             '
#                                                  '
#                               '        .          .        '
#                                .                          .
#                                .        .         '
#                                                 .         '
#                                 '                 '       .
#                                 .      .        . .
#                                  .                .       .
#                                                   .        .
#                                   '
#                                   .                .       '
#                                                             .
#                                   .                 .
#                                                             .
#                                    .                 .
#                                                             '
#                                    .                  .    .

#                                     '                  .  .

#                                     '                  '  .
#                                      .                 .
#                                       .                  '
#                                                         '
#                                        .               .

#                                         .               .
#                                          .

#                                        '  .             '
#                                       .
#                                            .            .
#                                       .
#                                      .      .            .
#                                            '      .
#                                     .     '  .            .
#                                   .      '  '      .
#                                   ooooOOOo,   .            .
#                                  d"      "Oo. -    ' '       .
#                                 d .        'O'.     .         .
#                                 O _.,oooo. .o             ooOOOOo.
#                                -O \OOOOOOOO.'  '    .   oOO"'   .O
#                               ' OoO\OOOOOOO/          .O'       .o
#                              '   "O;oOOOOo/   '      .O       .'o'
#                             o.   o;;;oOOo/           oO     -  ooOOOo
#                             OO'.oO;;;;OO.;    '     oOO .oooOOOOOOOo
#                             OOOOOO;;;;OO;;,   .     oOOOOOOOOOOOOOP
#                             OOOOOO;;;;OO;;;   '    .'"OO:;;;OOOOOO
#                              "OO:;;;;;OO;;; o'    . oO:;;;;' OOOO
#                                      'OO ,ooO     .OO;;;;;.   OO
#                                       ==oO "OOo  .OO;;;;;;;   OO
#                         :F_P:           OO- OoOOOOOO;;;;;;;   OO
#                                         OOOOOOOOOOOO;;;;;;;   OO
#                                          "OOOOOOOOOo;;;;;;;   OO
#                                              '"OOO";;;;"'     ==

                                                                   


from django.shortcuts import render

# Create your views here.
from django.contrib.auth.models import User, Group
from rest_framework import viewsets
from polls.serializer import *
from django.http import HttpResponse
import simplejson
from polls.serializer import *
import json
import xlrd


def ValuesQuerySetToDict(vqs):
    return [item for item in vqs]




def posiciones(request,plataforma):


	p=Posicion.objects.filter(localplataforma_id=plataforma).values('id','nombre','tipo__tp','estado_personal__nombre','estado_personal__color__nombre','interprete__nombre')

	data = json.dumps(ValuesQuerySetToDict(p))

	return HttpResponse(data, content_type="application/json")


def plataforma(request,plataforma):


	p=Posicion.objects.filter(localplataforma_id=plataforma)

	return render(request, 'plataforma.html',{'posiciones':p})


def cargapersonal(request,plataforma):



	xls_name = '/home/Mego.xls'

	# nombre
	# apellido
	# dni
	# iden

	book = xlrd.open_workbook(xls_name)

	sh = book.sheet_by_index(0)

	

	for rx in range(sh.nrows):

		sede=None
		nombre=None
		apellido=None
		iden=None
		nivel=None

		for col in range(sh.ncols):

			if rx >0:

				#print col,str(sh.row(rx)[col])

				if col==1: 
					apellido=str(sh.row(rx)[col]).split("'")[1]
					
				if col==2: 
					nombre=str(sh.row(rx)[col]).split("'")[1]
					
				if col==3: 
					iden=str(sh.row(rx)[col]).split(":")[1].split(".")[0]
				if col==4: 
					nivel=str(sh.row(rx)[col]).split("'")[1]
				if col==5: 

					print str(sh.row(rx)[col]).split("'")
					sede=str(sh.row(rx)[col]).split("'")[1]

				if sede =='MO':
					sede = 1
				if sede =='E':
					sede=3 
				if sede=='AQP':
					sede=4
				if sede=='NIC':
					sede=5
				if sede=='NA':
					sede=6

				

				if nivel=='MSI' or 'Msi':nivel=4
				if nivel=='CSI':nivel=3
				if nivel=='VRI':nivel=2
				if nivel=='CSA':nivel=1

				print 'sede',sede

		if nombre:

			

			Interprete(nombre=nombre,apellido=apellido,iden=iden,local_id=sede,nivel_id=nivel).save()

		print '------------'

	return render(request, 'plataforma.html',{'posiciones':'p'})

